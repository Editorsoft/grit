<!doctype html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<meta name="viewport" content="initial-scale=1">

		<title>PCSS</title>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
		
	</head>
	<body>
		<button id="process">fetch and process submissions</button>
		<button id="download" disabled>download reports</button>
		<div id="status">
			Submissions not fetched yet.
		</div>

		<script type="text/javascript">
			var processing = false;
			$("#process").click(function(){
				if (!processing) {
					processing = true;
					$("#download").prop('disabled', true);
					$("#status").html("Processing...");
					$.get("process", function(data,status){
						//alert("Data: " + data + "\nStatus: " + status);
						processing = false;
						$("#status").html("Submissions ready for download.");
						$("#download").prop('disabled', false);
					});
				}
			});
			$("#download").click(function(){
				window.open("STUDENT0.report.tex");
			});
		</script>
	</body>
</html>